name: UiPath-CI
env: 
  LOCAL_SCRIPT_DIR: C:\Users\riedelna\OneDrive - Sykes Enterprises, Incorporated\Desktop\CIScripts
on: [push]
jobs:
  Build:
    runs-on: self-hosted
    steps:
      - name: Clone repo
        uses: actions/checkout@v3
      - name: Build
        working-directory: ${{ env.LOCAL_SCRIPT_DIR }}
        run: | 
          $packName=py Build.py -i ${{ github.workspace }} -o temp\package
          echo "$packName built..."
          echo "::set-output name=content::$packName"
        id: packBuild
      - name: Upload package artifact  
        uses: actions/upload-artifact@v3
        with:
          name: ${{ steps.packBuild.outputs.content }}
          path: ${{ env.LOCAL_SCRIPT_DIR }}\temp\package\${{ steps.packBuild.outputs.content }}.nupkg
          retention-days: 1             
  DevDeploy:
    runs-on: self-hosted
    needs: Build
    steps:
      - name: Download package artifact
        working-directory: ${{ env.LOCAL_SCRIPT_DIR }}
        uses: actions/download-artifact@v3
        with:
          path: temp\artifact
        run: echo "Deployed to Dev"
  TestDeploy:
    runs-on: self-hosted
    needs: Build
    steps:
      - name: Deploying
        run: echo "Deployed to Test"
